#1
select p.firstName,p.lastName,a.city, a.state from Person p Left join Address a  on  p.personId = a.personId

CREATE FUNCTION getNthHighestSalary(N INT) RETURNS INT
BEGIN
  set N = N - 1;
  RETURN (
      # Write your MySQL query statement below.
      select distinct salary from Employee order by salary desc limit 1 offset N
  );
END

#department wise highest salary

select d.name as Department, e.name as Employee, e.salary as Salary from Employee e join Department d on d.id = e.departmentId  where (e.departmentId,e.salary) in (select e.departmentId, max(e.salary) from Employee e group by e.departmentId )

select e.name as Employee from Employee e join Employee e1 on e.managerId = e1.id where e.salary > e1.salary

#Duplicates
select email from Person group by email having count(*) >1

select w1.id from Weather w join Weather w1 on  DATEDIFF(w1.recordDate,  w.recordDate)  = 1 where w1.temperature > w.temperature

#Last 30 days record
select * from Weather where recordDate >= DATE_SUB(CURDATE(), INTERVAL 30 DAY)
SELECT *
FROM your_table
WHERE DATEDIFF(NOW(), recordDate) <= 30;

